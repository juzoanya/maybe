<%= render DS::Dialog.new do |dialog| %>
  <% dialog.with_header(title: t(".title")) %>
  <% dialog.with_body do %>
    <%= styled_form_with model: @entry, url: confirm_create_valuations_path, class: "space-y-4", data: { controller: "transaction-form", family_currency: Current.family.currency, account_currency: @entry.account.currency } do |form| %>
      <%= form.hidden_field :account_id %>

      <% if @error_message.present? %>
        <%= render DS::Alert.new(message: @error_message, variant: :error) %>
      <% end %>

      <div class="space-y-3">
        <%= form.date_field :date, label: true, required: true, value: Date.current, min: Entry.min_supported_date, max: Date.current %>
        <%= form.money_field :amount, label: t(".amount"), required: true, disable_currency: true %>
        
    <div class="form-field hidden" data-transaction-form-target="exchangeRateField">
      <%= form.label :exchange_rate, t(".exchange_rate"), class: "form-field__label" do %>
        <%= t(".exchange_rate") %>
        <span class="text-red-500 ml-0.5">*</span>
      <% end %>
      <div class="form-field__body">
        <div class="flex items-center gap-2">
          <span class="text-subdued text-sm">1 <span data-transaction-form-target="selectedCurrency"></span> =</span>
          <%= form.number_field :exchange_rate,
              class: "form-field__input",
              placeholder: "1.0",
              step: "0.000001",
              min: "0.000001",
              required: false,
              value: @entry.exchange_rate || 1.0 %>
          <span class="text-subdued text-sm"><%= Current.family.currency %></span>
        </div>
        <p class="text-xs text-subdued mt-1">
          <%= t(".exchange_rate_help", from: "%{from}", to: Current.family.currency) %>
        </p>
      </div>
    </div>
      </div>

      <%= form.submit t(".submit") %>
    <% end %>
  <% end %>
<% end %>
